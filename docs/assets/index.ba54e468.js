import{r as B,a as h,d as O,o as ee,b as te,c as I,e as y,n as M,f as ne,g as N,t as P,h as $,p as Y,i as q,j as se,k as oe,l as ie}from"./vendor.861eb19a.js";const re=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};re();const C=Math.PI;function z(e,t){return e+t}function ae(e){return e*e}function K(e,t,s,r,n,o){e.beginPath(),e.moveTo(t,s),e.arc(t+r/2,s-n+2,n,.72*C,2.26*C),e.lineTo(t+r,s),e.arc(t+r+n-2,s+r/2,n,1.21*C,2.78*C),e.lineTo(t+r,s+r),e.lineTo(t,s+r),e.arc(t+n-2,s+r/2,n+.4,2.76*C,1.24*C,!0),e.lineTo(t,s),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[o](),e.globalCompositeOperation="destination-over"}function le(e,t){const s=document.createElement("img");return s.crossOrigin="Anonymous",s.onload=t,s.onerror=()=>{s.src=L(e)},s.src=L(e),s}function _(e,t){return Math.round(Math.random()*(t-e)+e)}function L(e){const t=e.length;return t>0?e[_(0,t-1)]:"https://source.unsplash.com/300x150/?book,library"}function ue(e,t,s={leading:!0,trailing:!0}){const{leading:r,trailing:n,resultCallback:o}=s;let i=0,f=null;const p=function(...u){return new Promise((c,m)=>{const a=new Date().getTime();!i&&!r&&(i=a);const l=t-(a-i);if(l<=0){f&&(clearTimeout(f),f=null);const v=e.apply(this,u);o&&o(v),c(v),i=a;return}n&&!f&&(f=setTimeout(()=>{f=null,i=r?new Date().getTime():0;const v=e.apply(this,u);o&&o(v),c(v)},l))})};return p.cancel=function(){f&&clearTimeout(f),f=null,i=0},p}function ce(){const e=B({x:0,y:0}),t=h(!1),s=h(!1),r=h(0),n=h([]);return{origin:e,success:t,isMouseDown:s,timestamp:r,trail:n,start:u=>{t.value||(u instanceof MouseEvent?(e.x=u.clientX,e.y=u.clientY):(e.x=u.changedTouches[0].pageX,e.y=u.changedTouches[0].pageY),s.value=!0,r.value=Date.now())},move:(u,c,m)=>{if(!s.value)return!1;let a=0,l=0;if(c instanceof MouseEvent?(a=c.clientX-e.x,l=c.clientY-e.y):(a=c.changedTouches[0].pageX-e.x,l=c.changedTouches[0].pageY-e.y),a<0||a+38>=u)return!1;m(a),n.value.push(l)},end:(u,c)=>{if(!s.value||(s.value=!1,(u instanceof MouseEvent?u.clientX:u.changedTouches[0].pageX)===e.x))return!1;r.value=Date.now()-r.value,c(r.value)},verify:(u,c,m)=>{const a=n.value,l=a.reduce(z)/a.length,v=a.map(k=>k-l),w=Math.sqrt(v.map(ae).reduce(z)/a.length),E=parseInt(u);return m=m<=1?1:m>10?10:m,{spliced:Math.abs(E-c)<=m,TuringTest:l!==w}}}}var U=(e,t)=>{const s=e.__vccOpts||e;for(const[r,n]of t)s[r]=n;return s};const de=O({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50}},emits:["success","again","fail","refresh"],setup(e,{emit:t}){const{imgs:s,l:r,r:n,w:o,h:i,accuracy:f,interval:p}=e,u=h(!0),c=h(0),m=h(0),a=B({containerActive:!1,containerSuccess:!1,containerFail:!1}),l=B({iconCls:"arrow-right",width:"0",left:"0"}),v=h(),w=h(),E=h(),k=h();let T;const{success:A,start:R,move:W,end:G,verify:H}=ce(),j=()=>{var d,g;A.value=!1,a.containerActive=!1,a.containerSuccess=!1,a.containerFail=!1,l.iconCls="arrow-right",l.left="0",l.width="0",v.value.style.left="0",(d=k.value)==null||d.clearRect(0,0,o,i),(g=w.value)==null||g.clearRect(0,0,o,i),v.value.width=o,T.src=L(s)},J=()=>{j(),t("refresh")};function Q(d){l.left=d+"px";let g=(o-40-20)/(o-40)*d;v.value.style.left=g+"px",a.containerActive=!0,l.width=d+"px"}function Z(d){const{spliced:g,TuringTest:S}=H(v.value.style.left,c.value,f);if(g){if(f===-1){a.containerSuccess=!0,l.iconCls="success",A.value=!0,t("success",d);return}S?(a.containerSuccess=!0,l.iconCls="success",A.value=!0,t("success",d)):(a.containerFail=!0,l.iconCls="fail",t("again"))}else a.containerFail=!0,l.iconCls="fail",t("fail"),setTimeout(()=>{j()},1e3)}const F=ue(d=>{W(o,d,Q)},p),D=d=>{G(d,Z)};return ee(()=>{var S,V;const d=(S=E.value)==null?void 0:S.getContext("2d"),g=(V=v.value)==null?void 0:V.getContext("2d");k.value=d,w.value=g,T=le(s,()=>{u.value=!1;const b=r+n*2+3;if(c.value=_(b+10,o-(b+10)),m.value=_(10+n*2,i-(b+10)),d&&g){K(d,c.value,m.value,r,n,"fill"),K(g,c.value,m.value,r,n,"clip"),d.drawImage(T,0,0,o,i),g.drawImage(T,0,0,o,i);const X=m.value-n*2-1,x=g.getImageData(c.value,X,b,b);v.value.width=b,g.putImageData(x,0,X)}}),document.addEventListener("mousemove",F),document.addEventListener("mouseup",D)}),te(()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",D)}),{block:v,canvas:E,loadBlock:u,containerCls:a,sliderBox:l,refresh:J,sliderDown:R,touchStartEvent:R,touchMoveEvent:F,touchEndEvent:D}}}),fe=e=>(Y("data-v-f61c42f2"),e=e(),q(),e),ve=["width","height"],me=fe(()=>y("i",{class:"iconfont icon-refresh"},null,-1)),pe=[me],ge=["width","height"],he={class:"slide-verify-slider-text"};function ye(e,t,s,r,n,o){return $(),I("div",{id:"slideVerify",class:"slide-verify",style:N({width:e.w+"px"}),onselectstart:"return false;"},[y("div",{class:M({"slider-verify-loading":e.loadBlock})},null,2),y("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,ve),e.show?($(),I("div",{key:0,class:"slide-verify-refresh-icon",onClick:t[0]||(t[0]=(...i)=>e.refresh&&e.refresh(...i))},pe)):ne("",!0),y("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,ge),y("div",{class:M(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[y("div",{class:"slide-verify-slider-mask",style:N({width:e.sliderBox.width})},[y("div",{class:"slide-verify-slider-mask-item",style:N({left:e.sliderBox.left}),onMousedown:t[1]||(t[1]=(...i)=>e.sliderDown&&e.sliderDown(...i)),onTouchstart:t[2]||(t[2]=(...i)=>e.touchStartEvent&&e.touchStartEvent(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.touchMoveEvent&&e.touchMoveEvent(...i)),onTouchend:t[4]||(t[4]=(...i)=>e.touchEndEvent&&e.touchEndEvent(...i))},[y("i",{class:M(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),y("span",he,P(e.sliderText),1)],2)],4)}var be=U(de,[["render",ye],["__scopeId","data-v-f61c42f2"]]),Ce="./assets/img.b6b220bc.jpg",we="./assets/img1.182c2f76.jpg",Ee="./assets/img2.3217378f.jpg",ke="./assets/img3.5b97d210.jpg",Te="./assets/img4.708137a5.jpg",Se="./assets/img5.96696b7b.jpg";const Ae=O({components:{SlideVerify:be},setup(){const e=h(""),t=h();return{block:t,msg:e,text:"\u5411\u53F3\u6ED1\u52A8->",accuracy:1,imgs:[Ce,we,Ee,ke,Te,Se],onAgain:()=>{var p;e.value="\u68C0\u6D4B\u5230\u975E\u4EBA\u4E3A\u64CD\u4F5C\u7684\u54E6\uFF01 try again",(p=t.value)==null||p.refresh()},onSuccess:p=>{e.value=`login success, \u8017\u65F6${(p/1e3).toFixed(1)}s`},onFail:()=>{e.value="\u9A8C\u8BC1\u4E0D\u901A\u8FC7"},onRefresh:()=>{e.value="\u6ED1\u5757\u91CD\u7F6E\u4E86"},handleClick:()=>{var p;(p=t.value)==null||p.refresh(),e.value=""}}}}),Fe=e=>(Y("data-v-44860bb2"),e=e(),q(),e),De=Fe(()=>y("h1",null,"Vue3 + Typescript Slide Verify",-1));function Be(e,t,s,r,n,o){const i=se("slide-verify");return $(),I("div",null,[De,oe(i,{ref:"block",imgs:e.imgs,"slider-text":e.text,accuracy:e.accuracy,onAgain:e.onAgain,onSuccess:e.onSuccess,onFail:e.onFail,onRefresh:e.onRefresh},null,8,["imgs","slider-text","accuracy","onAgain","onSuccess","onFail","onRefresh"]),y("button",{class:"btn",onClick:t[0]||(t[0]=(...f)=>e.handleClick&&e.handleClick(...f))},"\u5728\u7236\u7EC4\u4EF6\u53EF\u4EE5\u70B9\u6211\u5237\u65B0\u54E6"),y("div",null,P(e.msg),1)])}var Ie=U(Ae,[["render",Be],["__scopeId","data-v-44860bb2"]]);ie(Ie).mount("#app");
