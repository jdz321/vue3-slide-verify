import{r as I,a as m,d as P,o as ee,b as te,c as M,e as g,n as N,f as ne,g as _,t as Y,h as $,p as j,i as q,j as se,k as oe,l as ie}from"./vendor.861eb19a.js";const re=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};re();const C=Math.PI;function z(e,t){return e+t}function le(e){return e*e}function K(e,t,s,r,n,o){e.beginPath(),e.moveTo(t,s),e.arc(t+r/2,s-n+2,n,.72*C,2.26*C),e.lineTo(t+r,s),e.arc(t+r+n-2,s+r/2,n,1.21*C,2.78*C),e.lineTo(t+r,s+r),e.lineTo(t,s+r),e.arc(t+n-2,s+r/2,n+.4,2.76*C,1.24*C,!0),e.lineTo(t,s),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[o](),e.globalCompositeOperation="destination-over"}function ae(e,t){const s=document.createElement("img");return s.crossOrigin="Anonymous",s.onload=t,s.onerror=()=>{s.src=L(e)},s.src=L(e),s}function A(e,t){return Math.round(Math.random()*(t-e)+e)}function L(e){const t=e.length;return t>0?e[A(0,t-1)]:"https://picsum.photos/300/150/?image="+A(0,1084)}function ue(e,t,s={leading:!0,trailing:!0}){const{leading:r,trailing:n,resultCallback:o}=s;let i=0,a=null;const w=function(...c){return new Promise((d,p)=>{const l=new Date().getTime();!i&&!r&&(i=l);const u=t-(l-i);if(u<=0){a&&(clearTimeout(a),a=null);const v=e.apply(this,c);o&&o(v),d(v),i=l;return}n&&!a&&(a=setTimeout(()=>{a=null,i=r?new Date().getTime():0;const v=e.apply(this,c);o&&o(v),d(v)},u))})};return w.cancel=function(){a&&clearTimeout(a),a=null,i=0},w}function ce(){const e=I({x:0,y:0}),t=m(!1),s=m(!1),r=m(0),n=m([]);return{origin:e,success:t,isMouseDown:s,timestamp:r,trail:n,start:c=>{t.value||(c instanceof MouseEvent?(e.x=c.clientX,e.y=c.clientY):(e.x=c.changedTouches[0].pageX,e.y=c.changedTouches[0].pageY),s.value=!0,r.value=Date.now())},move:(c,d,p)=>{if(!s.value)return!1;let l=0,u=0;if(d instanceof MouseEvent?(l=d.clientX-e.x,u=d.clientY-e.y):(l=d.changedTouches[0].pageX-e.x,u=d.changedTouches[0].pageY-e.y),l<0||l+38>=c)return!1;p(l),n.value.push(u)},end:(c,d)=>{if(!s.value||(s.value=!1,(c instanceof MouseEvent?c.clientX:c.changedTouches[0].pageX)===e.x))return!1;r.value=Date.now()-r.value,d(r.value)},verify:(c,d,p)=>{const l=n.value,u=l.reduce(z)/l.length,v=l.map(k=>k-u),E=Math.sqrt(v.map(le).reduce(z)/l.length),b=parseInt(c);return p=p<=1?1:p>10?10:p,{spliced:Math.abs(b-d)<=p,TuringTest:u!==E}}}}var U=(e,t)=>{const s=e.__vccOpts||e;for(const[r,n]of t)s[r]=n;return s};const de=P({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50}},emits:["success","again","fail","refresh"],setup(e,{emit:t}){const{imgs:s,l:r,r:n,w:o,h:i,accuracy:a,interval:w}=e,c=m(!0),d=m(0),p=m(0),l=I({containerActive:!1,containerSuccess:!1,containerFail:!1}),u=I({iconCls:"arrow-right",width:"0",left:"0"}),v=m(),E=m(),b=m(),k=m();let T;const{success:F,start:R,move:W,end:G,verify:H}=ce(),V=()=>{var f,h;F.value=!1,l.containerActive=!1,l.containerSuccess=!1,l.containerFail=!1,u.iconCls="arrow-right",u.left="0",u.width="0",v.value.style.left="0",(f=k.value)==null||f.clearRect(0,0,o,i),(h=E.value)==null||h.clearRect(0,0,o,i),v.value.width=o,T.src=L(s)},J=()=>{V(),t("refresh")};function Q(f){u.left=f+"px";let h=(o-40-20)/(o-40)*f;v.value.style.left=h+"px",l.containerActive=!0,u.width=f+"px"}function Z(f){const{spliced:h,TuringTest:S}=H(v.value.style.left,d.value,a);if(h){if(a===-1){l.containerSuccess=!0,u.iconCls="success",F.value=!0,t("success",f);return}S?(l.containerSuccess=!0,u.iconCls="success",F.value=!0,t("success",f)):(l.containerFail=!0,u.iconCls="fail",t("again"))}else l.containerFail=!0,u.iconCls="fail",t("fail"),setTimeout(()=>{V()},1e3)}const D=ue(f=>{W(o,f,Q)},w),B=f=>{G(f,Z)};return ee(()=>{var S,X;const f=(S=b.value)==null?void 0:S.getContext("2d"),h=(X=v.value)==null?void 0:X.getContext("2d");k.value=f,E.value=h,T=ae(s,()=>{c.value=!1;const y=r+n*2+3;if(d.value=A(y+10,o-(y+10)),p.value=A(10+n*2,i-(y+10)),f&&h){K(f,d.value,p.value,r,n,"fill"),K(h,d.value,p.value,r,n,"clip"),f.drawImage(T,0,0,o,i),h.drawImage(T,0,0,o,i);const O=p.value-n*2-1,x=h.getImageData(d.value,O,y,y);v.value.width=y,h.putImageData(x,0,O)}}),document.addEventListener("mousemove",D),document.addEventListener("mouseup",B)}),te(()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",B)}),{block:v,canvas:b,loadBlock:c,containerCls:l,sliderBox:u,refresh:J,sliderDown:R,touchStartEvent:R,touchMoveEvent:D,touchEndEvent:B}}}),fe=e=>(j("data-v-f61c42f2"),e=e(),q(),e),ve=["width","height"],pe=fe(()=>g("i",{class:"iconfont icon-refresh"},null,-1)),he=[pe],me=["width","height"],ge={class:"slide-verify-slider-text"};function ye(e,t,s,r,n,o){return $(),M("div",{id:"slideVerify",class:"slide-verify",style:_({width:e.w+"px"}),onselectstart:"return false;"},[g("div",{class:N({"slider-verify-loading":e.loadBlock})},null,2),g("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,ve),e.show?($(),M("div",{key:0,class:"slide-verify-refresh-icon",onClick:t[0]||(t[0]=(...i)=>e.refresh&&e.refresh(...i))},he)):ne("",!0),g("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,me),g("div",{class:N(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[g("div",{class:"slide-verify-slider-mask",style:_({width:e.sliderBox.width})},[g("div",{class:"slide-verify-slider-mask-item",style:_({left:e.sliderBox.left}),onMousedown:t[1]||(t[1]=(...i)=>e.sliderDown&&e.sliderDown(...i)),onTouchstart:t[2]||(t[2]=(...i)=>e.touchStartEvent&&e.touchStartEvent(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.touchMoveEvent&&e.touchMoveEvent(...i)),onTouchend:t[4]||(t[4]=(...i)=>e.touchEndEvent&&e.touchEndEvent(...i))},[g("i",{class:N(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),g("span",ge,Y(e.sliderText),1)],2)],4)}var Ce=U(de,[["render",ye],["__scopeId","data-v-f61c42f2"]]);const we=P({components:{SlideVerify:Ce},setup(){const e=m(""),t=m();return{block:t,msg:e,text:"\u5411\u53F3\u6ED1\u52A8->",accuracy:1,onAgain:()=>{var a;e.value="\u68C0\u6D4B\u5230\u975E\u4EBA\u4E3A\u64CD\u4F5C\u7684\u54E6\uFF01 try again",(a=t.value)==null||a.refresh()},onSuccess:a=>{e.value=`login success, \u8017\u65F6${(a/1e3).toFixed(1)}s`},onFail:()=>{e.value="\u9A8C\u8BC1\u4E0D\u901A\u8FC7"},onRefresh:()=>{e.value="\u6ED1\u5757\u91CD\u7F6E\u4E86"},handleClick:()=>{var a;(a=t.value)==null||a.refresh(),e.value=""}}}}),Ee=e=>(j("data-v-8fbd7378"),e=e(),q(),e),be=Ee(()=>g("h1",null,"Vue3 + Typescript Slide Verify",-1));function ke(e,t,s,r,n,o){const i=se("slide-verify");return $(),M("div",null,[be,oe(i,{ref:"block","slider-text":e.text,accuracy:e.accuracy,onAgain:e.onAgain,onSuccess:e.onSuccess,onFail:e.onFail,onRefresh:e.onRefresh},null,8,["slider-text","accuracy","onAgain","onSuccess","onFail","onRefresh"]),g("button",{class:"btn",onClick:t[0]||(t[0]=(...a)=>e.handleClick&&e.handleClick(...a))},"\u5728\u7236\u7EC4\u4EF6\u53EF\u4EE5\u70B9\u6211\u5237\u65B0\u54E6"),g("div",null,Y(e.msg),1)])}var Te=U(we,[["render",ke],["__scopeId","data-v-8fbd7378"]]);ie(Te).mount("#app");
