import{r as T,a as p,d as P,o as x,c as B,b as m,n as D,e as ee,f as I,t as q,g as M,p as j,h as z,i as ne,j as te,k as se}from"./vendor.dc5453c4.js";const oe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}};oe();const C=Math.PI;function K(e,n){return e+n}function ae(e){return e*e}function W(e,n,s,a,t,o){e.beginPath(),e.moveTo(n,s),e.arc(n+a/2,s-t+2,t,.72*C,2.26*C),e.lineTo(n+a,s),e.arc(n+a+t-2,s+a/2,t,1.21*C,2.78*C),e.lineTo(n+a,s+a),e.lineTo(n,s+a),e.arc(n+t-2,s+a/2,t+.4,2.76*C,1.24*C,!0),e.lineTo(n,s),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[o](),e.globalCompositeOperation="destination-over"}function re(e,n){const s=document.createElement("img");return s.crossOrigin="Anonymous",s.onload=n,s.onerror=()=>{s.src=$(e)},s.src=$(e),s}function S(e,n){return Math.round(Math.random()*(n-e)+e)}function $(e){const n=e.length;return n>0?e[S(0,n)]:"https://picsum.photos/300/150/?image="+S(0,1084)}function ie(){const e=T({x:0,y:0}),n=p(!1),s=p(!1),a=p(0),t=p([]);return{origin:e,success:n,isMouseDown:s,timestamp:a,trail:t,start:l=>{n.value||(l instanceof MouseEvent?(e.x=l.clientX,e.y=l.clientY):(e.x=l.changedTouches[0].pageX,e.y=l.changedTouches[0].pageY),s.value=!0,a.value=Date.now())},move:(l,d,u)=>{if(!s.value)return!1;let i=0,f=0;if(d instanceof MouseEvent?(i=d.clientX-e.x,f=d.clientY-e.y):(i=d.changedTouches[0].pageX-e.x,f=d.changedTouches[0].pageY-e.y),i<0||i+38>=l)return!1;u(i),t.value.push(f)},end:(l,d)=>{if(!s.value||(s.value=!1,(l instanceof MouseEvent?l.clientX:l.changedTouches[0].pageX)===e.x))return!1;a.value=Date.now()-a.value,d(a.value)},verify:(l,d,u)=>{const i=t.value,f=i.reduce(K)/i.length,E=i.map(y=>y-f),w=Math.sqrt(E.map(ae).reduce(K)/i.length),b=parseInt(l);return u=u<=1?1:u>10?10:u,{spliced:Math.abs(b-d)<=u,TuringTest:f!==w}}}}var G=(e,n)=>{const s=e.__vccOpts||e;for(const[a,t]of n)s[a]=t;return s};const le=P({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]}},emits:["success","again","fail","refresh"],setup(e,{emit:n}){const{imgs:s,l:a,r:t,w:o,h:r,accuracy:v}=e,A=p(!0),l=p(0),d=p(0),u=T({containerActive:!1,containerSuccess:!1,containerFail:!1}),i=T({iconCls:"arrow-right",width:"0",left:"0"}),f=p(),E=p(),w=p(),b=p();let y;const{success:F,start:N,move:_,end:R,verify:H}=ie(),L=()=>{var c,h;F.value=!1,u.containerActive=!1,u.containerSuccess=!1,u.containerFail=!1,i.iconCls="arrow-right",i.left="0",i.width="0",f.value.style.left="0",(c=b.value)==null||c.clearRect(0,0,o,r),(h=E.value)==null||h.clearRect(0,0,o,r),f.value.width=o,y.src=$(s)},J=()=>{L(),n("refresh")};function V(c){i.left=c+"px";let h=(o-40-20)/(o-40)*c;f.value.style.left=h+"px",u.containerActive=!0,i.width=c+"px"}function X(c){const{spliced:h,TuringTest:k}=H(f.value.style.left,l.value,v);if(h){if(v===-1){u.containerSuccess=!0,i.iconCls="success",F.value=!0,n("success",c);return}k?(u.containerSuccess=!0,i.iconCls="success",F.value=!0,n("success",c)):(u.containerFail=!0,i.iconCls="fail",n("again"))}else u.containerFail=!0,i.iconCls="fail",n("fail"),setTimeout(()=>{L()},1e3)}const Q=c=>{_(o,c,V)},U=c=>{R(c,X)};return x(()=>{var k,O;const c=(k=w.value)==null?void 0:k.getContext("2d"),h=(O=f.value)==null?void 0:O.getContext("2d");b.value=c,E.value=h,y=re(s,()=>{A.value=!1;const g=a+t*2+3;if(l.value=S(g+10,o-(g+10)),d.value=S(10+t*2,r-(g+10)),c&&h){W(c,l.value,d.value,a,t,"fill"),W(h,l.value,d.value,a,t,"clip"),c.drawImage(y,0,0,o,r),h.drawImage(y,0,0,o,r);const Y=d.value-t*2-1,Z=h.getImageData(l.value,Y,g,g);f.value.width=g,h.putImageData(Z,0,Y)}}),document.addEventListener("mousemove",g=>{_(o,g,V)}),document.addEventListener("mouseup",g=>{R(g,X)})}),{block:f,canvas:w,loadBlock:A,containerCls:u,sliderBox:i,refresh:J,sliderDown:N,touchStartEvent:N,touchMoveEvent:Q,touchEndEvent:U}}}),ue=e=>(j("data-v-74359359"),e=e(),z(),e),ce=["width","height"],de=ue(()=>m("i",{class:"iconfont icon-refresh"},null,-1)),fe=[de],ve=["width","height"],he={class:"slide-verify-slider-text"};function pe(e,n,s,a,t,o){return M(),B("div",{id:"slideVerify",class:"slide-verify",style:I({width:e.w+"px"}),onselectstart:"return false;"},[m("div",{class:D({"slider-verify-loading":e.loadBlock})},null,2),m("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,ce),e.show?(M(),B("div",{key:0,class:"slide-verify-refresh-icon",onClick:n[0]||(n[0]=(...r)=>e.refresh&&e.refresh(...r))},fe)):ee("",!0),m("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,ve),m("div",{class:D(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[m("div",{class:"slide-verify-slider-mask",style:I({width:e.sliderBox.width})},[m("div",{class:"slide-verify-slider-mask-item",style:I({left:e.sliderBox.left}),onMousedown:n[1]||(n[1]=(...r)=>e.sliderDown&&e.sliderDown(...r)),onTouchstart:n[2]||(n[2]=(...r)=>e.touchStartEvent&&e.touchStartEvent(...r)),onTouchmove:n[3]||(n[3]=(...r)=>e.touchMoveEvent&&e.touchMoveEvent(...r)),onTouchend:n[4]||(n[4]=(...r)=>e.touchEndEvent&&e.touchEndEvent(...r))},[m("i",{class:D(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),m("span",he,q(e.sliderText),1)],2)],4)}var me=G(le,[["render",pe],["__scopeId","data-v-74359359"]]);const ge=P({components:{SlideVerify:me},setup(){const e=p(""),n=p();return{block:n,msg:e,text:"\u5411\u53F3\u6ED1\u52A8->",accuracy:1,onAgain:()=>{var v;e.value="\u68C0\u6D4B\u5230\u975E\u4EBA\u4E3A\u64CD\u4F5C\u7684\u54E6\uFF01 try again",(v=n.value)==null||v.refresh()},onSuccess:v=>{e.value=`login success, \u8017\u65F6${(v/1e3).toFixed(1)}s`},onFail:()=>{e.value="\u9A8C\u8BC1\u4E0D\u901A\u8FC7"},onRefresh:()=>{e.value="\u6ED1\u5757\u91CD\u7F6E\u4E86"},handleClick:()=>{var v;(v=n.value)==null||v.refresh(),e.value=""}}}}),ye=e=>(j("data-v-8fbd7378"),e=e(),z(),e),Ce=ye(()=>m("h1",null,"Vue3 + Typescript Slide Verify",-1));function Ee(e,n,s,a,t,o){const r=ne("slide-verify");return M(),B("div",null,[Ce,te(r,{ref:"block","slider-text":e.text,accuracy:e.accuracy,onAgain:e.onAgain,onSuccess:e.onSuccess,onFail:e.onFail,onRefresh:e.onRefresh},null,8,["slider-text","accuracy","onAgain","onSuccess","onFail","onRefresh"]),m("button",{class:"btn",onClick:n[0]||(n[0]=(...v)=>e.handleClick&&e.handleClick(...v))},"\u5728\u7236\u7EC4\u4EF6\u53EF\u4EE5\u70B9\u6211\u5237\u65B0\u54E6"),m("div",null,q(e.msg),1)])}var we=G(ge,[["render",Ee],["__scopeId","data-v-8fbd7378"]]);se(we).mount("#app");
