import{r as D,a as h,d as O,o as x,b as ee,c as I,e as m,n as M,f as ne,g as $,t as Y,h as N,p as P,i as q,j as te,k as se,l as oe}from"./vendor.861eb19a.js";const re=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}};re();const C=Math.PI;function j(e,n){return e+n}function ae(e){return e*e}function z(e,n,s,r,t,o){e.beginPath(),e.moveTo(n,s),e.arc(n+r/2,s-t+2,t,.72*C,2.26*C),e.lineTo(n+r,s),e.arc(n+r+t-2,s+r/2,t,1.21*C,2.78*C),e.lineTo(n+r,s+r),e.lineTo(n,s+r),e.arc(n+t-2,s+r/2,t+.4,2.76*C,1.24*C,!0),e.lineTo(n,s),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[o](),e.globalCompositeOperation="destination-over"}function ie(e,n){const s=document.createElement("img");return s.crossOrigin="Anonymous",s.onload=n,s.onerror=()=>{s.src=_(e)},s.src=_(e),s}function S(e,n){return Math.round(Math.random()*(n-e)+e)}function _(e){const n=e.length;return n>0?e[S(0,n-1)]:"https://picsum.photos/300/150/?image="+S(0,1084)}function le(){const e=D({x:0,y:0}),n=h(!1),s=h(!1),r=h(0),t=h([]);return{origin:e,success:n,isMouseDown:s,timestamp:r,trail:t,start:l=>{n.value||(l instanceof MouseEvent?(e.x=l.clientX,e.y=l.clientY):(e.x=l.changedTouches[0].pageX,e.y=l.changedTouches[0].pageY),s.value=!0,r.value=Date.now())},move:(l,d,u)=>{if(!s.value)return!1;let i=0,f=0;if(d instanceof MouseEvent?(i=d.clientX-e.x,f=d.clientY-e.y):(i=d.changedTouches[0].pageX-e.x,f=d.changedTouches[0].pageY-e.y),i<0||i+38>=l)return!1;u(i),t.value.push(f)},end:(l,d)=>{if(!s.value||(s.value=!1,(l instanceof MouseEvent?l.clientX:l.changedTouches[0].pageX)===e.x))return!1;r.value=Date.now()-r.value,d(r.value)},verify:(l,d,u)=>{const i=t.value,f=i.reduce(j)/i.length,E=i.map(g=>g-f),w=Math.sqrt(E.map(ae).reduce(j)/i.length),b=parseInt(l);return u=u<=1?1:u>10?10:u,{spliced:Math.abs(b-d)<=u,TuringTest:f!==w}}}}var K=(e,n)=>{const s=e.__vccOpts||e;for(const[r,t]of n)s[r]=t;return s};const ue=O({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]}},emits:["success","again","fail","refresh"],setup(e,{emit:n}){const{imgs:s,l:r,r:t,w:o,h:a,accuracy:v}=e,A=h(!0),l=h(0),d=h(0),u=D({containerActive:!1,containerSuccess:!1,containerFail:!1}),i=D({iconCls:"arrow-right",width:"0",left:"0"}),f=h(),E=h(),w=h(),b=h();let g;const{success:F,start:L,move:U,end:W,verify:G}=le(),R=()=>{var c,p;F.value=!1,u.containerActive=!1,u.containerSuccess=!1,u.containerFail=!1,i.iconCls="arrow-right",i.left="0",i.width="0",f.value.style.left="0",(c=b.value)==null||c.clearRect(0,0,o,a),(p=E.value)==null||p.clearRect(0,0,o,a),f.value.width=o,g.src=_(s)},H=()=>{R(),n("refresh")};function J(c){i.left=c+"px";let p=(o-40-20)/(o-40)*c;f.value.style.left=p+"px",u.containerActive=!0,i.width=c+"px"}function Q(c){const{spliced:p,TuringTest:k}=G(f.value.style.left,l.value,v);if(p){if(v===-1){u.containerSuccess=!0,i.iconCls="success",F.value=!0,n("success",c);return}k?(u.containerSuccess=!0,i.iconCls="success",F.value=!0,n("success",c)):(u.containerFail=!0,i.iconCls="fail",n("again"))}else u.containerFail=!0,i.iconCls="fail",n("fail"),setTimeout(()=>{R()},1e3)}const T=c=>{U(o,c,J)},B=c=>{W(c,Q)};return x(()=>{var k,V;const c=(k=w.value)==null?void 0:k.getContext("2d"),p=(V=f.value)==null?void 0:V.getContext("2d");b.value=c,E.value=p,g=ie(s,()=>{A.value=!1;const y=r+t*2+3;if(l.value=S(y+10,o-(y+10)),d.value=S(10+t*2,a-(y+10)),c&&p){z(c,l.value,d.value,r,t,"fill"),z(p,l.value,d.value,r,t,"clip"),c.drawImage(g,0,0,o,a),p.drawImage(g,0,0,o,a);const X=d.value-t*2-1,Z=p.getImageData(l.value,X,y,y);f.value.width=y,p.putImageData(Z,0,X)}}),document.addEventListener("mousemove",T),document.addEventListener("mouseup",B)}),ee(()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",B)}),{block:f,canvas:w,loadBlock:A,containerCls:u,sliderBox:i,refresh:H,sliderDown:L,touchStartEvent:L,touchMoveEvent:T,touchEndEvent:B}}}),ce=e=>(P("data-v-2f9639f2"),e=e(),q(),e),de=["width","height"],fe=ce(()=>m("i",{class:"iconfont icon-refresh"},null,-1)),ve=[fe],pe=["width","height"],he={class:"slide-verify-slider-text"};function me(e,n,s,r,t,o){return N(),I("div",{id:"slideVerify",class:"slide-verify",style:$({width:e.w+"px"}),onselectstart:"return false;"},[m("div",{class:M({"slider-verify-loading":e.loadBlock})},null,2),m("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,de),e.show?(N(),I("div",{key:0,class:"slide-verify-refresh-icon",onClick:n[0]||(n[0]=(...a)=>e.refresh&&e.refresh(...a))},ve)):ne("",!0),m("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,pe),m("div",{class:M(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[m("div",{class:"slide-verify-slider-mask",style:$({width:e.sliderBox.width})},[m("div",{class:"slide-verify-slider-mask-item",style:$({left:e.sliderBox.left}),onMousedown:n[1]||(n[1]=(...a)=>e.sliderDown&&e.sliderDown(...a)),onTouchstart:n[2]||(n[2]=(...a)=>e.touchStartEvent&&e.touchStartEvent(...a)),onTouchmove:n[3]||(n[3]=(...a)=>e.touchMoveEvent&&e.touchMoveEvent(...a)),onTouchend:n[4]||(n[4]=(...a)=>e.touchEndEvent&&e.touchEndEvent(...a))},[m("i",{class:M(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),m("span",he,Y(e.sliderText),1)],2)],4)}var ge=K(ue,[["render",me],["__scopeId","data-v-2f9639f2"]]);const ye=O({components:{SlideVerify:ge},setup(){const e=h(""),n=h();return{block:n,msg:e,text:"\u5411\u53F3\u6ED1\u52A8->",accuracy:1,onAgain:()=>{var v;e.value="\u68C0\u6D4B\u5230\u975E\u4EBA\u4E3A\u64CD\u4F5C\u7684\u54E6\uFF01 try again",(v=n.value)==null||v.refresh()},onSuccess:v=>{e.value=`login success, \u8017\u65F6${(v/1e3).toFixed(1)}s`},onFail:()=>{e.value="\u9A8C\u8BC1\u4E0D\u901A\u8FC7"},onRefresh:()=>{e.value="\u6ED1\u5757\u91CD\u7F6E\u4E86"},handleClick:()=>{var v;(v=n.value)==null||v.refresh(),e.value=""}}}}),Ce=e=>(P("data-v-c0eedc34"),e=e(),q(),e),Ee=Ce(()=>m("h1",null,"Vue3 + Typescript Slide Verify",-1));function we(e,n,s,r,t,o){const a=te("slide-verify");return N(),I("div",null,[Ee,se(a,{ref:"block","slider-text":e.text,accuracy:e.accuracy,onAgain:e.onAgain,onSuccess:e.onSuccess,onFail:e.onFail,onRefresh:e.onRefresh},null,8,["slider-text","accuracy","onAgain","onSuccess","onFail","onRefresh"]),m("button",{class:"btn",onClick:n[0]||(n[0]=(...v)=>e.handleClick&&e.handleClick(...v))},"\u5728\u7236\u7EC4\u4EF6\u53EF\u4EE5\u70B9\u6211\u5237\u65B0\u54E6"),m("div",null,Y(e.msg),1)])}var be=K(ye,[["render",we],["__scopeId","data-v-c0eedc34"]]);oe(be).mount("#app");
